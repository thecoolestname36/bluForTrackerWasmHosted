@page "/"
@using BluForTracker.Client.Shared.Services;

<h1>Loading...</h1>

@code {
    [Inject] public required NavigationManager NavManager { get; set; }
    [Inject] public required IGeolocationService GeolocationService { get; set; }
    protected override async Task OnAfterRenderAsync(bool firstRender)
    {
        await base.OnAfterRenderAsync(firstRender);
        while(await Permissions.CheckStatusAsync<Permissions.LocationAlways>() != PermissionStatus.Granted)
        {
            await Permissions.RequestAsync<Permissions.LocationAlways>();
        }
        await GeolocationService.Init();
        NavManager.NavigateTo("/main");
    }
}
